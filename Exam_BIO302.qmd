---
title: "Exam BIO302"
author: "Anette Aune"
format:
  html:
    self-contained: true
execute: 
  warning: false
  message: false
editor: visual
date: today
---

In this first part of my exam in BIO302 (spring, 2023) I will attempt to reproduce a figure from a paper from the authors archived data.

Getting the data

The exact paper I have used is Predicting the nationwide outmigration timing of Atlantic salmon (Salmo salar) smolts along 12 degrees of latitude in Norway, by Vollset et al. (2020).

Link to the paper: https://onlinelibrary.wiley.com/doi/epdf/10.1111/ddi.13285

The data I have used in is downloaded from: 
https://datadryad.org/stash/dataset/doi:10.5061%2Fdryad.p2ngf1vq9


```{r}
#| label: packages-and-data 

# Load necessary packages 
library(here)
library(tidyverse)
library(broom)
#library(patchwork)
library(viridis) 

# Get the data into RStudio
smolt_data <- read_csv(here("smoltOut.csv"),
                       locale = locale(encoding = "ISO-8859-1"))|> # for R to be able to read "Ã¥"
  janitor::clean_names() 

```

## Making the figure

The paper contains only 1 short sentence about how they did the data visualization, however their figure 1 is easy to read and it should be possible to reproduce.

```{r}
#| label: fig-25-migration
#| fig-height: 7
#| fig-width: 9
#| fig-cap: "Tile plot of raw data of day of 25% migration for *Salmo salar* in different Norwegian rivers and years."

# Reordering the rivers by latitudinal placement before plotting (same order as original figure). 
#(none of the things I tried within ggplot to change this did work.)
smolt_data$river <- reorder(smolt_data$river, smolt_data$lat)


(smolt_fig <- ggplot(data = smolt_data, 
                     aes(x = fyear, y = river)) +
   geom_tile(aes(fill = d25)) + 
   scale_fill_viridis(option = "plasma") + # to get the same color scale as the original paper
   theme_classic() + 
   labs(x = "Year",
        y = "River",
        fill = "Date of 25% migration") + 
  theme(legend.position = "top",
         #legend.text = element_text(size = 8),
         legend.key.width = unit(2, 'cm'),
        legend.key.height = unit(0.4, 'cm'))
) 
```
